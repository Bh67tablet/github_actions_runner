#!/bin/bash
pat=
OWNER=VFDE-CICDandCloud
REPO=CICD-Mobile_bh67
#
REG_TOKEN=$( curl -L   -X POST   -H "Accept: application/vnd.github+json"   -H "Authorization: Bearer $pat"   https://github.vodafone.com/api/v3/repos/$OWNER/$REPO/actions/runners/registration-token | jq .token --raw-output)
mkdir actions-runner && cd actions-runner
curl -o actions-runner-linux-x64-2.299.2.tar.gz -L -H 'Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IlE4QWNRSzhlRVZINFNpZjlJS2loSmlPd05KMCJ9.eyJuYW1laWQiOiJkZGRkZGRkZC1kZGRkLWRkZGQtZGRkZC1kZGRkZGRkZGRkZGQiLCJzY3AiOiJBY3Rpb25zUnVudGltZS5QYWNrYWdlRG93bmxvYWQiLCJJZGVudGl0eVR5cGVDbGFpbSI6IlN5c3RlbTpTZXJ2aWNlSWRlbnRpdHkiLCJodHRwOi8vc2NoZW1hcy54bWxzb2FwLm9yZy93cy8yMDA1LzA1L2lkZW50aXR5L2NsYWltcy9zaWQiOiJERERERERERC1ERERELUREREQtRERERC1EREREREREREREREQiLCJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL3ByaW1hcnlzaWQiOiJkZGRkZGRkZC1kZGRkLWRkZGQtZGRkZC1kZGRkZGRkZGRkZGQiLCJhdWkiOiJlYzQ4NTRkMC1mZTc1LTQ5YzQtYTFkNC1mMjY5YWVlNDU5MTUiLCJzaWQiOiI3NDc4NTU2Ny02NmI1LTQ5ZDctYmM0Yy02NzBjMWMyODIzMzMiLCJpc3MiOiJnaXRodWIudm9kYWZvbmUuY29tIiwiYXVkIjoiZ2l0aHViLnZvZGFmb25lLmNvbS9fc2VydmljZXMvdnN0b2tlbiIsIm5iZiI6MTcwNTU4MDg0NiwiZXhwIjoxNzA1NTg1MDQ2fQ.DYjzoVARXbNpgmF3PSKLw2XNLGAZmzP4gB6bzH7b1ohMDpkGv3KASbrj-JP2JKr6LTn4GFKrhreV33AfFZEBIC8yBKWi4aMZWiZVPZ5Q_Hyd3HG81mjZCOzCr59XqwQntn_UTv2os_uNiMU6T5ooGB75TwgayOcJf3nO5vTGYpYHQGVFQocfovGr1EMvjUGb3eJnbgpmjEwwpYyuJ87p9kMlJ7su0dFqnIjge9Gjkp7C1OzmymH5JeKGwFRC5bycMdpGKQA0JdTj7ijuCXwRw1OafdfEhkwpCiFkT0IxSXruD_s-i_9BlZ8KVw8u04JgWOWAoAjg00QhCnO1pwHFOi4Wy_1iDrRcvcO8PEnZlrWafaK3hCW4x9ynQ0n0hgStuMighRtpYLBc1j3i6LYfTGOPMZIPOPcle0uweEuSIRDuPhzS6L2Ugjdy-ijrVF5wJlm1eywUmXReq63qm732-lwE5oxUBhMx7bqxFnvYZwizcbkb6_914NvVELvAyJsMDu8aZidqok2kLjYsKyZOMY7tD5fMfqCR84CP9wWiDeN4uH3nvJ1NlXbIWQScd0s3Mq9tJMo9voPGDMpFlUmsQKjEjTj0gchoW6i35_ZMscs8A7aZT3NfJhnvtFjKozQCysID--9piMd96sk7pyQp_7_0CLg4Doz2o98FWcQU3Wk' https://github.vodafone.com/_services/pipelines/_apis/distributedtask/packagedownload/agent/linux-x64/2.299.2
tar xzf ./actions-runner-linux-x64-2.299.2.tar.gz
sudo ./config.sh --unattended --url https://github.vodafone.com/VFDE-CICDandCloud/CICD-Mobile_bh67 --token $REG_TOKEN --labels bh67
#./run.sh
sudo ./svc.sh install
sudo ./svc.sh start
